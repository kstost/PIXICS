(()=>{var t={262:(t,e,n)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),a=new E(i||[]);return o._invoke=function(t,e,n){var i=y;return function(r,o){if(i===d)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return G()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=B(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===y)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var c=h(t,e,n);if("normal"===c.type){if(i=n.done?p:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=p,n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var y="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function g(){}function x(){}function w(){}var k={};u(k,a,(function(){return this}));var b=Object.getPrototypeOf,m=b&&b(b(O([])));m&&m!==n&&r.call(m,a)&&(k=m);var _=w.prototype=g.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(o,a,s,c){var u=h(t[o],t,a);if("throw"!==u.type){var l=u.arg,y=l.value;return y&&"object"===i(y)&&r.call(y,"__await")?e.resolve(y.__await).then((function(t){n("next",t,s,c)}),(function(t){n("throw",t,s,c)})):e.resolve(y).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,c)}))}c(u.arg)}var o;this._invoke=function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return o=o?o.then(r,r):r()}}function B(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,B(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=h(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function O(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:G}}function G(){return{value:e,done:!0}}return x.prototype=w,u(_,"constructor",w),u(w,"constructor",x),x.displayName=u(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,c,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},S(C.prototype),u(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new C(l(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(_),u(_,c,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:O(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}("object"===i(t=n.nmd(t))?t.exports:{});try{regeneratorRuntime=r}catch(t){"object"===("undefined"==typeof globalThis?"undefined":i(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},129:(t,e,n)=>{t.exports=n(262)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i](o,o.exports,n),o.loaded=!0,o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";function t(e){return t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t(e)}function e(t,n){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,n)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function r(t,n,o){return r=i()?Reflect.construct:function(t,n,i){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(t,r));return i&&e(o,i.prototype),o},r.apply(null,arguments)}function o(n){var i="function"==typeof Map?new Map:void 0;return o=function(n){if(null===n||(o=n,-1===Function.toString.call(o).indexOf("[native code]")))return n;var o;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(n))return i.get(n);i.set(n,a)}function a(){return r(n,arguments,t(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),e(a,n)},o(n)}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e,n,i,r,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){u(o,i,r,a,s,"next",t)}function s(t){u(o,i,r,a,s,"throw",t)}a(void 0)}))}}function h(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function f(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,y(t,e,"set"),n),n}function d(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,y(t,e,"get"))}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&e(t,n)}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function x(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=n(129),S=n.n(_);function C(t,e,n){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,n)}function B(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=t(e);if(n){var o=t(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return x(this,i)}}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}window.pixiInst=function(){function t(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=n.length,r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*i));return e}var e=Symbol.for("INACTIVE"+t(64)),n=Symbol.for("DRAWINGPROFILE"+t(64)),i=function(){function t(){w(this,t)}return b(t,null,[{key:"validate",value:function(t,e){if(!0!==e())throw new Error(t)}}]),t}();m(i,"use",!0);var r={easeOutElastic:function(t,e,n,i){var r=1.70158,o=0,a=n;return 0==t?e:1==(t/=i)?e+n:(o||(o=.3*i),a<Math.abs(n)?(a=n,r=o/4):r=o/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*t)*Math.sin((t*i-r)*(2*Math.PI)/o)+n+e)},linearTween:function(t,e,n,i){return n*t/i+e},easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return t/=i,n*(--t*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return t/=i,-n*(--t*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return t/=i,n*(--t*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return n*(1-Math.pow(2,-10*t/i))+e},easeInOutExpo:function(t,e,n,i){return(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:(t--,n/2*(2-Math.pow(2,-10*t))+e)},easeInCirc:function(t,e,n,i){return t/=i,-n*(Math.sqrt(1-t*t)-1)+e},easeOutCirc:function(t,e,n,i){return t/=i,t--,n*Math.sqrt(1-t*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:(t-=2,n/2*(Math.sqrt(1-t*t)+1)+e)}},a={Ease:r,Ease2:{easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeInOutExpo:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e}},BIGNUMBER:999999999999999,EPSILON:1e-7,get_angle_in_radian_between_two_points:function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},get_distance_between_two_point:function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},get_coordinate_distance_away_from_center_with_radian:function(t,e,n){return n+=Math.PI,{x:e.x+Math.cos(n)*t,y:e.y+Math.sin(n)*t}},are_overlap_two_circle:function(t,e){return!(t.r+e.r-a.get_distance_between_two_point(t,e)<=0)},prevent_overlap_two_circle:function(t,e,n){var i=t.r+e.r,r=i-a.get_distance_between_two_point(t,e);if(!(r<=0)){r*=n;var o=a.get_angle_in_radian_between_two_points(t,e);return[a.get_coordinate_distance_away_from_center_with_radian(r*(t.r/i)*-1,t,o),a.get_coordinate_distance_away_from_center_with_radian(r*(e.r/i)*1,e,o)]}},check_intersection_line_circle:function(t,e){for(var n,i,r=Math.sqrt,o=null,a=1e-7,s=t.second.x-t.first.x,c=t.second.y-t.first.y,u=r(s*s+c*c),l=s/u,h=c/u,y=l*(e.x-t.first.x)+h*(e.y-t.first.y),f=y*l+t.first.x,d=y*h+t.first.y,p=r((f-e.x)*(f-e.x)+(d-e.y)*(d-e.y)),v=function(t,e){for(var n=t.r,i=Math.atan2(t.y-e.y,t.x-e.x)+Math.PI;;){e.x=t.x+Math.cos(i)*n,e.y=t.y+Math.sin(i)*n;var o=t.x-e.x,s=t.y-e.y;if(r(o*o+s*s)>=t.r)return e;n+=a}},g=0;g<3;g++){g>1&&(g=-1);var x=t.first.x-e.x,w=t.first.y-e.y,k=t.second.x-e.x,b=t.second.y-e.y,m=a*g;n=r(x*x+w*w)+m,i=r(k*k+b*b)+m;var _=n>=e.r,S=i>=e.r,C=_&&i<e.r||S&&n<e.r;if(p<e.r){var B=r(e.r*e.r-p*p)-a,A=y-B,P=y+B,E=l*s+h*c,O=A<0||A>E,G=P<0||P>E;!C&&O&&G?o=[]:C&&O?o=[v(e,{x:P*l+t.first.x,y:P*h+t.first.y})]:C&&G&&(o=[v(e,{x:A*l+t.first.x,y:A*h+t.first.y})]),!o&&_&&S&&(o=[v(e,{x:A*l+t.first.x,y:A*h+t.first.y}),v(e,{x:P*l+t.first.x,y:P*h+t.first.y})])}else if(p==e.r){var M={x:f,y:d},F={x:f,y:d},I=ksttool.math.get_angle_in_radian_between_two_points(e,M),T=ksttool.math.get_coordinate_distance_away_from_center_with_radian(ksttool.math.get_distance_between_two_point(e,M)+a,e,I);ksttool.check_intersection_line_line({first:e,second:T},t,!0)&&(o=[M=v(e,M),F=v(e,F)])}if(o||C||(o=[]),null!==o||-1==g)return o}return[]},check_intersection_line_line:function(t,e){var n,i,r,o,a=[t.first.x,t.first.y,t.second.x,t.second.y,e.first.x,e.first.y,e.second.x,e.second.y,!1],s=a[0],c=a[1],u=a[2],l=a[3],h=a[4],y=a[5],f=a[6],d=a[7];return 0!=(n=(d-y)*(u-s)-(f-h)*(l-c))&&(o=(u-s)*(i=c-y)-(l-c)*(r=s-h),i=((f-h)*i-(d-y)*r)/n,r=o/n,a[8]?{x:s+i*(u-s),y:c+i*(l-c),onLine1:i>0&&i<1,onLine2:r>0&&r<1}:i>0&&i<1&&r>0&&r<1&&{x:s+i*(u-s),y:c+i*(l-c)})},pieAsNum:function(t,e,n,i){var r=2*Math.PI-Math.PI/2+t,o=1*Math.PI,s=2*Math.PI/e,c=a.rotation_coordinate(n,i,r),u=o+a.get_angle_in_radian_between_two_points(n,c);return Math.round((u-u%s)/s)},checkPointIsInsideCircle:function(t,e){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)<=t.r*t.r},rotation_coordinate:function(t,e,n){var i=Math.cos(n),r=Math.sin(n);return{x:i*(e.x-t.x)+r*(e.y-t.y)+t.x,y:i*(e.y-t.y)-r*(e.x-t.x)+t.y}},checkPointIsInsideRect:function(t,e,n,i){var r=t.x-.5*n*1,o=t.y-.5*i*1,a=t.x+.5*n*1,s=t.y+.5*i*1;return e.x>=r&&e.y>=o&&e.x<=a&&e.y<=s},make_cross_by_centerpoint:function(t,e,n){var i=[];void 0===n&&(n=1e8);var r=a.get_coordinate_distance_away_from_center_with_radian(n,t,-e),o=a.get_coordinate_distance_away_from_center_with_radian(-2*n,r,-e);i.push({first:r,second:o});var s=a.get_coordinate_distance_away_from_center_with_radian(n,t,-e+.5*Math.PI),c=a.get_coordinate_distance_away_from_center_with_radian(-2*n,s,-e+.5*Math.PI);return i.push({first:s,second:c}),i}},s=function(){for(var t=0,e=0;e<arguments.length;e++){var n=arguments[e];n.constructor!==Number||Number.isNaN(n)||t++}return t===arguments.length},u=function(){function t(t,e,n,i,r){t[Symbol.for("resolver")]=e,t[Symbol.for("removeUpdate")]=n,void 0!==i&&(t[Symbol.for("timecount")]=i),r.set(t)}function y(t,e,n){e.has(t)&&(e.delete(t),t[Symbol.for("resolver")](n))}!function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.length,i=0;i<8;i++)e.charAt(Math.floor(Math.random()*n))}();var g,x,k=60,_={x:0,y:0},A=function(t){v(n,PIXI.Sprite);var e=B(n);function n(){w(this,n);var t=PIXI.Texture.from("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=");return e.call(this,t)}return b(n)}(),E=function(t){v(n,t);var e=B(n);function n(){var t;return w(this,n),m(p(t=e.call(this)),"spec",{}),t.anchor.y=.5,t.axis=.5,t.thickness=1,t}return b(n,[{key:"thickness",get:function(){return this.height},set:function(t){this.height=t}},{key:"axis",get:function(){return this.anchor.x},set:function(t){this.anchor.x=t}},{key:"ax",get:function(){var t;return null!==(t=this.spec.ax)&&void 0!==t?t:0},set:function(t){this.spec.ax=t,this.calcpos()}},{key:"ay",get:function(){var t;return null!==(t=this.spec.ay)&&void 0!==t?t:0},set:function(t){this.spec.ay=t,this.calcpos()}},{key:"bx",get:function(){var t;return null!==(t=this.spec.bx)&&void 0!==t?t:0},set:function(t){this.spec.bx=t,this.calcpos()}},{key:"by",get:function(){var t;return null!==(t=this.spec.by)&&void 0!==t?t:0},set:function(t){this.spec.by=t,this.calcpos()}},{key:"length",get:function(){var t=this.ax-this.bx,e=this.ay-this.by;return Math.sqrt(t*t+e*e)}},{key:"calcpos",value:function(){this.width=this.length,this.x=this.bx-(this.bx-this.ax)*(1-this.anchor.x),this.y=this.by-(this.by-this.ay)*(1-this.anchor.x),this.rotation=Math.atan2(this.by-this.ay,this.bx-this.ax)}}]),n}(A),O=function(t){v(n,PIXI.TilingSprite);var e=B(n);function n(t){var i;return w(this,n),m(p(i=e.call(this,t)),"spec",{}),i.anchor.y=.5,i.axis=.5,i.thickness=1,i}return b(n,[{key:"thickness",get:function(){return this.height},set:function(t){this.height=t}},{key:"axis",get:function(){return this.anchor.x},set:function(t){this.anchor.x=t}},{key:"ax",get:function(){var t;return null!==(t=this.spec.ax)&&void 0!==t?t:0},set:function(t){this.spec.ax=t,this.calcpos()}},{key:"ay",get:function(){var t;return null!==(t=this.spec.ay)&&void 0!==t?t:0},set:function(t){this.spec.ay=t,this.calcpos()}},{key:"bx",get:function(){var t;return null!==(t=this.spec.bx)&&void 0!==t?t:0},set:function(t){this.spec.bx=t,this.calcpos()}},{key:"by",get:function(){var t;return null!==(t=this.spec.by)&&void 0!==t?t:0},set:function(t){this.spec.by=t,this.calcpos()}},{key:"length",get:function(){var t=this.ax-this.bx,e=this.ay-this.by;return Math.sqrt(t*t+e*e)}},{key:"calcpos",value:function(){this.width=this.length,this.x=this.bx-(this.bx-this.ax)*(1-this.anchor.x),this.y=this.by-(this.by-this.ay)*(1-this.anchor.x),this.rotation=Math.atan2(this.by-this.ay,this.bx-this.ax)}}]),n}(),G=function(){function t(e){w(this,t),m(this,"pool",new Map),e&&(this.pool=[])}return b(t,[{key:"addOne",value:function(t){this.isDataMap()?this.pool.set(t):this.pool.push(t)}},{key:"pickOne",value:function(){var t;if(this.getSize())return this.isDataMap()?(t=this.pool.keys().next().value)&&this.pool.delete(t):t=this.pool.splice(0,1)[0],t}},{key:"getSize",value:function(){return this.isDataMap()?this.pool.size:this.pool.length}},{key:"isDataMap",value:function(){return this.pool.constructor===Map}},{key:"get",value:function(e,n,i){var r;if(!i&&this.getSize()&&!(r=this.pickOne())[t.resting])throw new Error("에러..");if(r||((r=e())[t.resting]=!0),!r[t.resting])throw new Error("에러..");return r[t.resting]=!1,r instanceof u.PhysicsGraphics&&r.setActive(!0),n&&n(r),r}},{key:"put",value:function(e,n){if(e[t.resting])return!1;if(e[t.resting]=!0,e instanceof u.PhysicsGraphics){if(!e.isActive())throw new Error("에러..");e.setActive(!1)}return n&&n(e),this.addOne(e),!0}},{key:"truncate",value:function(){for(;this.getSize();){var t=this.pickOne();t instanceof u.PhysicsGraphics&&t.destroy()}}}],[{key:"memoryMonitor",value:function(t){var e=$.ratio,n=new PIXI.Text("",{fontFamily:"Arial",fontSize:40*e,fill:16777215,align:"center"}),i=[];return setInterval((function(){i.push(performance.memory.usedJSHeapSize),i.length>100&&i.splice(0,1),n.text="".concat(Math.round(Math.min.apply(Math,i)/1024/1024)),n.x=(t-n.width)/2,n.y=n.height}),10),n}}]),t}();m(G,"resting",Symbol.for("resting"));var M=function(t){v(n,PIXI.Text);var e=B(n);function n(t,i){var r;return w(this,n),m(p(r=e.call(this,t,i)),"parentObject",null),r.anchor.x=.5,r.anchor.y=.5,r}return b(n,[{key:"image",get:function(){return this}},{key:"getSprite",value:function(){return this}},{key:"remove",value:function(){this.parentObject&&this.parentObject.removeVirtualChild(this)}},{key:"align",value:function(){if(this.parentObject){var t=this.parentObject.getGraphic(),e=this.getSprite();e.x=t.x,e.y=t.y,e.rotation=t.rotation}}}]),n}(),F=new WeakMap,I=new WeakMap,T=function(){function t(e,n){w(this,t),m(this,"image",null),C(this,F,{writable:!0,value:""}),C(this,I,{writable:!0,value:null}),this.text=e,this.opt=n}return b(t,[{key:"text",get:function(){return d(this,F)},set:function(t){f(this,F,"".concat(t)),this.draw()}},{key:"opt",get:function(){return d(this,I)},set:function(t){f(this,I,t),this.draw()}},{key:"draw",value:function(){if(this.opt&&this.text){var t,e;this.image&&(t=this.image.parentObject,e||(e={}),e.x=this.image.x,e.y=this.image.y,e.alpha=this.image.alpha,this.image.remove());var n=new PIXI.Text("".concat(this.text),this.opt);this.image=new u.Image($.pixiApp.renderer.generateTexture(n)),e&&(this.image.x=e.x,this.image.y=e.y,this.image.alpha=e.alpha),t&&t.addVirtualChild(this.image)}}},{key:"width",get:function(){return this.image.width}},{key:"height",get:function(){return this.image.height}},{key:"x",get:function(){return this.image.x},set:function(t){this.image.x=t}},{key:"y",get:function(){return this.image.y},set:function(t){this.image.y=t}}]),t}(),D=new WeakMap,L=new WeakMap,j=function(){function t(e){w(this,t),m(this,"parentObject",null),C(this,D,{writable:!0,value:0}),C(this,L,{writable:!0,value:0}),this.gr=new PIXI.Sprite(e),this.gr.anchor.x=.5,this.gr.anchor.y=.5,this.gr.scale.x=1*$.ratio,this.gr.scale.y=1*$.ratio,this.x=0,this.y=0}return b(t,[{key:"remove",value:function(){this.parentObject&&this.parentObject.removeVirtualChild(this)}},{key:"getSprite",value:function(){return this.gr}},{key:"align",value:function(){if(this.parentObject){var t=this.parentObject.getGraphic(),e=this.getSprite();e.x=t.x+this.x,e.y=t.y+this.y,e.rotation=t.rotation}}},{key:"alpha",get:function(){return this.gr.alpha},set:function(t){this.gr.alpha=t}},{key:"x",get:function(){return d(this,D)},set:function(t){f(this,D,t),this.align()}},{key:"y",get:function(){return d(this,L)},set:function(t){f(this,L,t),this.align()}},{key:"width",get:function(){return this.gr.width}},{key:"height",get:function(){return this.gr.height}},{key:"fitting",value:function(){var t=this.parentObject;this.gr.scale.x=t.getGraphic().width/this.gr.texture.width,this.gr.scale.y=t.getGraphic().height/this.gr.texture.height}}]),t}(),R=function(t){v(n,b2.ContactListener);var e=B(n);function n(){return w(this,n),e.call(this)}return b(n,[{key:"askFire",value:function(t,e,n,i){var r=t.GetFixtureA().GetBody().GetUserData(),o=t.GetFixtureB().GetBody().GetUserData();o.setContactState(r,e,n,t),r.setContactState(o,e,n,t)}},{key:"BeginContact",value:function(t){this.askFire(t,!0,n.BEGIN)}},{key:"EndContact",value:function(t){this.askFire(t,!1,n.END)}},{key:"PreSolve",value:function(t,e){this.askFire(t,!0,n.PRESOLVE,e)}},{key:"PostSolve",value:function(t,e){this.askFire(t,!0,n.POSTSOLVE,e)}}],[{key:"contactTranslator",value:function(t){var e=new b2.WorldManifold;return t.GetWorldManifold(e),e.points[0]}}]),n}();m(R,"BEGIN",0),m(R,"END",1),m(R,"PRESOLVE",2),m(R,"POSTSOLVE",3);var V=function(){function f(t){var e=t.world;if(w(this,f),m(this,"calculateMode",!1),m(this,"virtualChildren",new Map),m(this,"fixtureMapCache",new Map),m(this,"fixtureCache",Object.freeze([])),m(this,"activeState",{}),m(this,"resistanceFn",null),m(this,"stickState",new Map),m(this,"contacts",new Map),m(this,"ignoreContact",new Map),m(this,"interactiveEvents",{}),m(this,"kinematicMotionMove",new Map),m(this,"kinematicMotionRotate",new Map),m(this,"tag",null),m(this,"preCallbackQueueMode",!1),m(this,"preCallbackQueue",[]),m(this,"updateQueue",new Map),this.world=e,this.graphic=function(t){var e=new PIXI.Graphics,n={x:0,y:0},i={x:0,y:0};function r(e,n){i.x=e,i.y=n;var r=o,s=P({},r.GetLocalCenter());s.y=-s.y;var c=a.get_angle_in_radian_between_two_points(s,{x:0,y:0}),u=-a.get_distance_between_two_point({x:0,y:0},s),l=c-r.GetAngle(),h=a.get_coordinate_distance_away_from_center_with_radian(u,{x:0,y:0},l);r.gr.x=t.x+h.x+e,r.gr.y=t.y+h.y+-n}var o={gr:e,body:e,SetPosition:r,GetPosition:function(){var e=o,n=P({},e.GetLocalCenter());n.y=-n.y;var i=a.get_angle_in_radian_between_two_points(n,{x:0,y:0}),r=-a.get_distance_between_two_point({x:0,y:0},n),s=i-e.GetAngle(),c=a.get_coordinate_distance_away_from_center_with_radian(r,{x:0,y:0},s),u={x:e.gr.x,y:e.gr.y};return u.x-=t.x+c.x,u.y-=t.y+c.y,u.y=-u.y,u},SetLocalCenter:function(e,r){var s=o;n.x=e,n.y=r;var c=P({},s.GetLocalCenter());c.y=-c.y;var u=a.get_angle_in_radian_between_two_points(c,{x:0,y:0}),l=-a.get_distance_between_two_point({x:0,y:0},c),h=u-s.GetAngle(),y=a.get_coordinate_distance_away_from_center_with_radian(l,{x:0,y:0},h);s.gr.pivot.x=c.x,s.gr.pivot.y=c.y,s.gr.x=t.x+y.x+i.x,s.gr.y=t.y+y.y+-i.y},GetLocalCenter:function(){return n},SetAngle:function(t){e.rotation=-t},GetAngle:function(){return-e.rotation},drawingRectangle:function(t,n,i,r,o,a){!function(t,e,n,i,r,o,a){t.beginFill(o,a),t.drawRect(e-i,-n-r,2*i,2*r),t.endFill()}(e,t,n,i,r,o,a)},drawCircle:function(t,n,i,r,o){!function(t,e,n,i,r,o){t.beginFill(r,o),t.drawCircle(e,-n,i),t.endFill()}(e,t,n,i,r,o)},drawPolygon:function(t,n,i){!function(t,e,n,i){t.beginFill(n,i),e.forEach((function(e,n){0===n?t.moveTo(e.x,-e.y):t.lineTo(e.x,-e.y)})),t.closePath(),t.endFill()}(e,t,n,i)}};return r(0,0),o}(_),this.setContactable(!0),g)this.planckBody=e.createBody({bullet:!1}),this.planckBody.setGravityScale(1),this.planckBody.setUserData(this),this.planckBody.setMassData({mass:1,center:planck.Vec2(0,0),I:1});else{var n=new b2.BodyDef;n.allowSleeping=!0,this.planckBody=e.CreateBody(n),this.planckBody.SetGravityScale(1),this.planckBody.SetUserData(this);var i=new b2.MassData;i.mass=1,i.center.x=0,i.center.y=0,i.I=1,this.planckBody.SetMassData(i)}}var d;return b(f,[{key:"getPinGravities",value:function(){return this.pinGravity?h(this.pinGravity.keys()):[]}},{key:"remPinGravity",value:function(t){this.pinGravity&&(this.pinGravity.delete(t),0===this.pinGravity.size&&delete this.pinGravity)}},{key:"setPinGravity",value:function(t){var e=this;this.pinGravity||(this.pinGravity=new Map,this.setUpdate((function(){return e.applyForceByPinGravities()}))),t.constructor!==Array&&(t=[t]),t.forEach((function(t){e.pinGravity.set(t)}))}},{key:"applyForceByPinGravities",value:function(){var t=this;this.getPinGravities().forEach((function(e){t.applyForceByPinGravity(e)}))}},{key:"applyForceByPinGravity",value:function(t){var e=t.force,n=t.pos,i=this.getBody(),r=i.GetPosition();n.constructor===u.PhysicsGraphics?n=n.getPosition():n.constructor===Function&&(n=n());var o=new b2.Vec2(n.x/u.worldscale,n.y/u.worldscale),a=b2.Vec2.SubVV(o,r,new b2.Vec2);a.LengthSquared()<b2.epsilon_sq||(a.Normalize(),i.ApplyForce(b2.Vec2.MulSV(e,a,new b2.Vec2),r))}},{key:"setContactable",value:function(t){this.contactable=t}},{key:"getContactable",value:function(){return this.contactable}},{key:"isUpdating",value:function(t){return this.updateQueue.has(t)}},{key:"setUpdate",value:(d=l(S().mark((function e(n,i){var r=this;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.updateQueue.has(n)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new Promise((function(e){t(n,e,(function(t){return r.remUpdate(n,t)}),i,r.updateQueue)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"remUpdate",value:function(t,e){y(t,this.updateQueue,e)}},{key:"remAllUpdate",value:function(){for(var t=this.updateQueue.keys();;){var e=t.next();if(e.done)break;this.remUpdate(e.value)}}},{key:"setTag",value:function(t){this.tag=t}},{key:"getTag",value:function(){return this.tag}},{key:"isRelatedTo",value:function(t){return this.getRelations(t)}},{key:"getRelations",value:function(t){var e=this;if(t&&t===e)return!0;var n=new Map,i=new Map;for(i.set(e);;){var r=i.keys().next(),o=r.value;if(!o||r.done)break;for(var a=o.getContactList(),s=0;s<a.length;s++){var c=a[s];if(t&&t===c)return!0;i.has(c)||n.has(c)||i.set(c)}i.delete(o),n.set(o)}return!t&&(n.delete(e),h(n.keys()))}},{key:"getContactCount",value:function(){return this.getContactList().length}},{key:"addIgnoreContact",value:function(t){this.ignoreContact.set(t,!0)}},{key:"removeIgnoreContact",value:function(t){this.ignoreContact.delete(t)}},{key:"getIgnoreContacts",value:function(){return this.ignoreContact}},{key:"setContactState",value:function(t,e,n,i){if(!this.ignoreContact.has(t))if(e){var r=this.getCBFunc(t,"contact",!0);if(this.contacts.has(t))n===R.PRESOLVE&&null!=r&&r.needToCalcCollidedPos&&this.contacts.get(t).list.push(R.contactTranslator(i));else{var o={list:[]};this.contacts.set(t,o);var a,s=null==r?void 0:r.cbf;null!=r&&r.needToCalcCollidedPos&&o.list.push(R.contactTranslator(i)),r&&r.preCalc&&(a=r.preCalc()),this.preCallbackQueueMode?s&&s(t,a,o.list[0]):s&&this.preCallbackQueue.push([s,t,a,o.list[0]])}}else if(this.contacts.has(t)){var c,u=this.getCBFunc(t,"untact",!0);null!=u&&u.needToCalcCollidedPos&&(c=(c=this.contacts.get(t).list)[c.length-1]),this.contacts.delete(t);var l,h=null==u?void 0:u.cbf;u&&u.preCalc&&(l=u.preCalc()),this.preCallbackQueueMode?h&&h(t,l,c):h&&this.preCallbackQueue.push([h,t,l,c])}}},{key:"getCBFunc",value:function(t,e,n){var i,r=this.stickState.get(t);return n?null==r?void 0:r.cbs[e]:null==r||null===(i=r.cbs[e])||void 0===i?void 0:i.cbf}},{key:"removeEvent",value:function(t,e,n){var i=this;if(e){if(e instanceof f){!n&&e.removeEvent(t,this,!0);var r=this.stickState.get(e);if(!r)return;delete r.cbs[t],0===Object.keys(r.cbs).length&&this.stickState.delete(e)}}else t.constructor===String&&(t=[t]),t.forEach((function(t){var e=i.interactiveEvents[t];e&&(i.getGraphic().off(t,e),delete i.interactiveEvents[t])})),0===Object.keys(this.interactiveEvents).length&&(this.getGraphic().interactive=!1)}},{key:"emitEvent",value:function(t){var e=this;t.constructor===String&&(t=[t]);var n=new Map;t.forEach((function(t){var i=e.interactiveEvents[t];i&&!n.has(i)&&(n.set(i),e.getGraphic().emit(t))}))}},{key:"touch",value:function(){}},{key:"removeAllEvent",value:function(){this.removeAllContactEvent(),this.removeAllInteractionEvent()}},{key:"removeAllInteractionEvent",value:function(){var t=this;Object.keys(this.interactiveEvents).forEach((function(e){t.removeEvent(e)}))}},{key:"removeAllContactEvent",value:function(){var t=this,e=[];for(h(this.stickState.keys()).forEach((function(n){Object.keys(t.stickState.get(n).cbs).forEach((function(t){e.push([t,n])}))}));e.length;){var n=c(e.splice(0,1)[0],2),i=n[0],r=n[1];this.removeEvent(i,r)}}},{key:"isContactEventTo",value:function(t,e){try{if(this.stickState.get(e).cbs[t])return!0}catch(t){}try{if(e.stickState.get(this).cbs[t])return!0}catch(t){}return!1}},{key:"addEvent",value:function(t,e,n,i,r){var o=this;if(e instanceof Function)t.constructor===String&&(t=[t]),t.forEach((function(t){o.removeEvent(t),o.getGraphic().interactive=!0,o.interactiveEvents[t]=e,o.getGraphic().on(t,e)}));else if(e instanceof f){e.removeEvent(t,this);var a=this.stickState.get(e);a||(a={body:e,prevstate:!1,cbs:{}},this.stickState.set(e,a)),a.cbs[t]={cbf:n,preCalc:i,needToCalcCollidedPos:r}}}},{key:"getContactList",value:function(t){var e=h(this.contacts.keys());return t||(e=e.filter((function(t){return t.getContactable()}))),e}},{key:"easingTo",value:function(t,e,n,c){var u=this;i.use&&i.validate("easingTo::다이나믹 멈춰!",(function(){return!1===u.isDynamic()})),i.use&&i.validate("easingTo::숫자..",(function(){return s(t,n)})),i.use&&i.validate("easingTo::타입...",(function(){return!(null!==e&&!s(e))})),c||(c="linearTween"),c=r[c];var h,y,f,d,g=this,x=null!==e?z():Math.PI/2,_=16.666666666666668;null!==e?((h=this.getPosition()).y*=-1,y={x:t,y:e},f=a.get_angle_in_radian_between_two_points(h,y),d=a.get_distance_between_two_point(h,y)):(h=this.getAngle(),d=(y=t)-h);var C=null===e;if((!C||!this.kinematicMotionRotate.size)&&(C||!this.kinematicMotionMove.size)){for(var A=0,P=0,E=[];!((A+=_)>n);)V();var O=_-(A-n);if(O>1e8*Number.EPSILON&&(A+=O,A-=_,V()),E.filter((function(t){return t>x})).length){for(A=0,P=0,E=[];!((A+=x)>d);)E.push(A-P),P=A;var G=x-(A-d);G>1e8*Number.EPSILON&&(A+=G,A-=x,E.push(A-P),P=A)}var M=this.isStatic(),F=function(n){v(r,n);var i=B(r);function r(t,e){var n;return w(this,r),m(p(n=i.call(this,t.bind(e))),"running",!0),m(p(n),"drop",!1),n}return b(r,[{key:"pause",value:function(){this.running=!1}},{key:"play",value:function(){this.running=!0}},{key:"abort",value:function(){return this.drop=!0,this}},{key:"stopMotion",value:function(n,i,r,o){if(C?g.getBody().SetAngularVelocity(0):g.getBody().SetLinearVelocity(new b2.Vec2(0,0)),i){!C&&n&&g.setPosition(t,-e),C&&n&&g.setAngle(t+j,!0);var s=C?g.getAngle():g.getPosition(),c=C?s-r:a.get_distance_between_two_point(r,s);this.abort(),N().delete(R),i({difference:c,values:[r,s],duration:new Date-o})}}}]),r}(o(Promise)),I=0,T=new Date,D=C?g.getAngle():g.getPosition(),L=new F(function(){var t=l(S().mark((function t(e,n){return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,this;case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),g.setUpdate(U)),j=0,R={clearPrm:function(){L.abort();var t=void 0===E[I];if(L.drop||t)return L.stopMotion(t,U[Symbol.for("resolver")],D,T)},addValue:function(t){j+=t}};return N().set(R),L}function V(t,e){var i=A/n,r=e?i:c(i,0,1,1),o=r-P;P=r,E.push(o*d)}function N(){return C?g.kinematicMotionRotate:g.kinematicMotionMove}function U(t,e,n){if(!L.running)return L.stopMotion();var i=void 0===E[I];if(L.drop||i)return L.stopMotion(i,e,D,T);var r=E[I],o=E[I]/d;if(C)M&&g.setAngle(g.getAngle()+E[I],!0),!M&&g.getBody().SetAngularVelocity(r*k);else{var s=g.getPosition();if(s.y_=s.y,s.y*=-1,M){var c=-(D.x-y.x)*o,u=(-1*D.y-y.y)*o;g.setPosition(s.x+c,s.y_+u)}else{var l=W(r),h=a.get_coordinate_distance_away_from_center_with_radian(l,s,f);g.getBody().SetLinearVelocity(new b2.Vec2(h.x-s.x,s.y-h.y))}}I++}}},{key:"removeAllVirtualChildren",value:function(){h(this.virtualChildren.keys()).forEach((function(t){return t.remove()}))}},{key:"removeVirtualChild",value:function(t){this.virtualChildren.delete(t),t.getSprite().parent.removeChild(t.getSprite()),t.parentObject=null}},{key:"addVirtualChild",value:function(t,e){this.virtualChildren.has(t)||(this.virtualChildren.set(t),$.particleContainer.addChild(t.getSprite()),t.parentObject=this,t.align(),e&&t.fitting())}},{key:"setVirtualChildAlign",value:function(){for(var t=this.virtualChildren.keys();;){var e=t.next();if(e.done)break;e.value.align()}}},{key:"rotateEaseBy",value:function(t,e,n){var i=this.getAngle();return this.rotateEaseTo(i+t,e,n)}},{key:"moveEaseBy",value:function(t,e,n,i){var r=this.getPosition();return r.y*=-1,this.moveEaseTo(r.x+t,r.y+e,n,i)}},{key:"moveBy",value:function(t,e,n,i){var r=this.getPosition();return r.y*=-1,this.moveEaseTo(r.x+t,r.y+e,n,i)}},{key:"rotateEaseTo",value:function(t,e,n){return this.easingTo(t,null,e,n)}},{key:"moveEaseTo",value:function(t,e,n,i){return this.easingTo(t,e,n,i)}},{key:"moveTo",value:function(t,e,n,i){return this.easingTo(t,e,n,i)}},{key:"getGraphic",value:function(){return this.graphic.body}},{key:"drawJSON",value:function(t){var e=this,n=t.scale,i=t.json,r=$.ratio,o=this;i.layers.forEach((function(t){var s,c=t.class,u=t.restitution,l=t.density,h=t.friction,y=Number("0x"+t.color);if("polygon"===c){var f=t.dots[c].map((function(t){return{x:(t.x-i.pivotpoint.x)/i.scale*n*r,y:-(t.y-i.pivotpoint.y)/i.scale*n*r}}));s=f.length&&o.drawPolygon(f,y)}else if("rect"===c&&2===t.dots[c].length){var d=t.dots[c][0],p=t.dots[c][1],v=p.x-d.x,g=p.y-d.y;v*=.5,g*=.5,s=o.drawRect((d.x-i.pivotpoint.x+v)/i.scale*n*r,-(d.y-i.pivotpoint.y+g)/i.scale*n*r,v/i.scale*2*n*r,g/i.scale*2*n*r,y)}else if("circle"===c&&2===t.dots[c].length){var x=t.dots[c][0],w=t.dots[c][1],k=a.get_distance_between_two_point(x,w);s=o.drawCircle((x.x-i.pivotpoint.x)/i.scale*n*r,-(x.y-i.pivotpoint.y)/i.scale*n*r,k/i.scale*n*r,y)}if(s){var b=e.fixtureCache.length-1;b>-1&&(e.setFriction(h,b),e.setRestitution(u,b),e.setDensity(l,b))}}))}},{key:"removeDraw",value:function(t){var e=this;void 0!==t?(i.use&&i.validate("removeDraw::숫자가 아니네",(function(){return t.constructor===Number})),this.destroyFixture(this.numberToFixture(t))):this.fixtureCache.forEach((function(t){return e.destroyFixture(t)})),this.fixtureShapeDrawer()}},{key:"getDrawType",value:function(t){var e=this;return i.use&&i.validate("getDrawType::숫자가 아니네",(function(){return t.constructor===Number})),i.use&&i.validate("getDrawType::drawingProfile에 짝이 안맞음",(function(){return 3===Object.keys(e.numberToFixture(t)[n]).length})),i.use&&i.validate("getDrawType::픽스쳐가 아니네",(function(){return e.numberToFixture(t).constructor===b2.Fixture})),this.numberToFixture(t)[n].tcode}},{key:"setDrawAppearance",value:function(t,e,r){var o=this;i.use&&i.validate("setDrawAppearance::idx 숫자가 아니네",(function(){return t.constructor===Number})),i.use&&i.validate("setDrawAppearance::cidx 숫자가 아니네",(function(){return e.constructor===Number})),i.use&&i.validate("setDrawAppearance::value undefined네..",(function(){return void 0!==r}));var a=this.fixtureCache.map((function(t){return{values:o.getFixtureValues(t),rawArg:t[n].rawArg,tcode:t[n].tcode}}));a[t].rawArg[e]=r,this.removeDraw(),a.forEach((function(t,e){t.tcode===X.RECTANGLE?o.drawRect.apply(o,h(t.rawArg)):t.tcode===X.CIRCLE?o.drawCircle.apply(o,h(t.rawArg)):t.tcode===X.POLYGON&&o.drawPolygon.apply(o,h(t.rawArg)),Object.keys(t.values).forEach((function(n){o.setFixtureProp(t.values[n],n,e)}))}))}},{key:"setDrawColor",value:function(t,e,r){var o,a=this,s=this.getDrawType(t);s===X.RECTANGLE&&(o=[4,5]),s===X.POLYGON&&(o=[1,2]),s===X.CIRCLE&&(o=[3,4]),i.use&&i.validate("setDrawColor::idxs undefined네..",(function(){return void 0!==o})),i.use&&i.validate("setDrawColor::없는픽스쳐..",(function(){return void 0!==a.numberToFixture(t)}));var c=[e,r];o.forEach((function(e,i){null!=c[i]&&(a.numberToFixture(t)[n].rawArg[e]=c[i])})),this.fixtureShapeDrawer()}},{key:"createFixture",value:function(t){var e=this,n=this.planckBody.CreateFixture(t);return this.fixtureCache=this.getFixtures().reverse(),Object.freeze(this.fixtureCache),this.fixtureMapCache=new Map,this.fixtureCache.forEach((function(t){return e.fixtureMapCache.set(t)})),n}},{key:"destroyFixture",value:function(t){var e=this;i.use&&i.validate("destroyFixture::idx 소유하지 않은2 픽스쳐",(function(){return t[n].drawInstance.pg===e})),i.use&&i.validate("destroyFixture::idx 소유하지 않은1 픽스쳐",(function(){return e.isFixtureBelongsToMe(t)})),this.planckBody.DestroyFixture(t),this.fixtureCache=this.getFixtures().reverse(),Object.freeze(this.fixtureCache),this.fixtureMapCache=new Map,this.fixtureCache.forEach((function(t){return e.fixtureMapCache.set(t)}))}},{key:"isFixtureBelongsToMe",value:function(t){return i.use&&i.validate("isFixtureBelongsToMe::픽스쳐가 아니네",(function(){return t.constructor===b2.Fixture})),this.fixtureMapCache.has(t)}},{key:"fixtureShapeDrawer",value:function(){var t=this;this.graphic.body.clear(),this.fixtureCache.forEach((function(e){if(e[n].tcode===X.RECTANGLE){var i=c(e[n].rawArg,6),r=i[0],o=i[1],a=i[2],s=i[3],u=i[4],l=i[5];a*=.5,s*=.5,void 0===u&&(u=16777215),void 0===l&&(l=1),t.graphic.drawingRectangle(r,o,a,s,u,l)}if(e[n].tcode===X.POLYGON){var h=c(e[n].rawArg,3),y=h[0],f=h[1],d=h[2];void 0===f&&(f=16777215),void 0===d&&(d=1),t.graphic.drawPolygon(y,f,d)}if(e[n].tcode===X.CIRCLE){var p=c(e[n].rawArg,5),v=p[0],g=p[1],x=p[2],w=p[3],k=p[4];void 0===w&&(w=16777215),void 0===k&&(k=1),t.graphic.drawCircle(v,g,x,w,k)}}))}},{key:"drawRect",value:function(t,e,i,r,o,a){var s=new K({pg:this}),c=Array.prototype.slice.call(arguments);if(!g){var l=new b2.Vec2(t/u.worldscale,e/u.worldscale),h=new b2.PolygonShape;h.SetAsBox(.5*i/u.worldscale,.5*r/u.worldscale,l);var y=new b2.FixtureDef;y.shape=h,y.density=1,y.friction=1,y.restitution=0;var f=this.createFixture(y);return f[n]={drawInstance:s,rawArg:c,tcode:X.RECTANGLE},this.fixtureShapeDrawer(),f}}},{key:"drawPolygon",value:function(t,e,i){var r=new H({pg:this}),o=Array.prototype.slice.call(arguments);if(!g){var a=JSON.parse(JSON.stringify(t)).map((function(t){return t.x/=u.worldscale,t.y/=u.worldscale,new b2.Vec2(t.x,t.y)})),s=new b2.PolygonShape;s.Set(a);var c=new b2.FixtureDef;c.shape=s,c.density=1,c.friction=1,c.restitution=0;var l=this.createFixture(c);return l[n]={drawInstance:r,rawArg:o,tcode:X.POLYGON},this.fixtureShapeDrawer(),l}}},{key:"drawCircle",value:function(t,e,i,r,o){var a=new Y({pg:this}),s=Array.prototype.slice.call(arguments);if(!g){var c=new b2.CircleShape;c.m_radius=i/u.worldscale,c.m_p.Set(t/u.worldscale,e/u.worldscale);var l=new b2.FixtureDef;l.shape=c,l.density=1,l.friction=1,l.restitution=0;var h=this.createFixture(l);return h[n]={drawInstance:a,rawArg:s,tcode:X.CIRCLE},this.fixtureShapeDrawer(),h}}},{key:"syncState",value:function(){if(g){this.graphic.rotation=-this.planckBody.getAngle();var t=this.planckBody.getPosition();this.graphic.x=t.x*u.worldscale,this.graphic.y=-t.y*u.worldscale}else{var e=this.planckBody.GetPosition(),n=e.x,i=e.y;this.graphic.SetAngle(this.planckBody.GetAngle()),this.graphic.SetPosition(n*u.worldscale,i*u.worldscale),this.setVirtualChildAlign()}}},{key:"GetAngle",value:function(){return this.getAngle.apply(this,arguments)}},{key:"SetAngle",value:function(){return this.setAngle.apply(this,arguments)}},{key:"GetPosition",value:function(){return this.getPosition.apply(this,arguments)}},{key:"SetPosition",value:function(){return arguments[0].constructor===b2.Vec2?this.setPosition(arguments[0].x,arguments[0].y):this.setPosition.apply(this,arguments)}},{key:"setAngle",value:function(t,e){var n,i=this;!e&&this.kinematicMotionRotate.size&&(n=this.getAngle()),g?this.planckBody.setAngle(t):this.planckBody.SetAngle(t),this.syncState(),this.touchContacts(),e||void 0===n||h(this.kinematicMotionRotate.keys()).forEach((function(t){return t.addValue(i.getAngle()-n)}))}},{key:"getAngle",value:function(){return g?this.planckBody.getAngle():this.planckBody.GetAngle()}},{key:"setPosition",value:function(t,e){void 0!==t&&void 0!==e&&(g?this.planckBody.setPosition(planck.Vec2(t/u.worldscale,-e/u.worldscale)):this.planckBody.SetPosition(new b2.Vec2(t/u.worldscale,e/u.worldscale)),this.syncState(),this.touchContacts())}},{key:"getPosition",value:function(){var t=g?this.planckBody.getPosition():this.planckBody.GetPosition();return{x:t.x*u.worldscale,y:t.y*u.worldscale}}},{key:"touchContacts",value:function(){var t=this.getContactList(!0);this.getBody().SetAwake(!0);for(var e=0;e<t.length;e++)t[e].getBody().SetAwake(!0)}},{key:"getBody",value:function(){return this.planckBody}},{key:"getDraw",value:function(t){return this.numberToFixture(t)[n].drawInstance}},{key:"setFixtureFilterGroupIndex",value:function(t){for(var e=this.getFixtures(),n=0;n<e.length;n++)e[n].GetFilterData().groupIndex=t}},{key:"setFixtureFilterData",value:function(t){var e=t.groupIndex,n=t.categoryBits,i=t.maskBits;if(void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),null!==i||null!==n||null!==e)for(var r=this.getFixtures(),o=0;o<r.length;o++){var a=r[o].GetFilterData();null!==i&&(a.maskBits=i),null!==e&&(a.groupIndex=e),null!==n&&(a.categoryBits=n)}}},{key:"getFixtureValues",value:function(t){i.use&&i.validate("getFixtureValues::idx 상태가 이상하네",(function(){return void 0!==t})),i.use&&i.validate("getFixtureValues::idx 허용되지 못하는 값",(function(){return t.constructor===b2.Fixture||t.constructor===Number}));var e=this.numberToFixture(t),n=null==e?void 0:e.GetRestitution(),r=null==e?void 0:e.GetFriction(),o=null==e?void 0:e.GetDensity();return{restitution:n,friction:r,density:o=o||1,sensor:null==e?void 0:e.IsSensor()}}},{key:"getFixtures",value:function(){for(var t=[],e=this.planckBody.GetFixtureList();e;e=e.GetNext())t.push(e);return t}},{key:"setFixtureProp",value:function(t,e,n){var i={density:g?"setDensity":"SetDensity",restitution:g?"setRestitution":"SetRestitution",friction:g?"setFriction":"SetFriction",sensor:"SetSensor"}[e];void 0===n?this.fixtureCache.forEach((function(e){return e[i](t)})):this.numberToFixture(n)[i](t)}},{key:"getFixtureProp",value:function(t,e){var n={density:g?"getDensity":"GetDensity",restitution:g?"getRestitution":"GetRestitution",friction:g?"getFriction":"GetFriction",sensor:"IsSensor"}[t];return this.numberToFixture(e)[n]()}},{key:"numberToFixture",value:function(t){var e=this;return i.use&&i.validate("numberToFixture::idx 상태가 이상하네",(function(){return!(null==t)})),i.use&&i.validate("numberToFixture::idx 허용되지 못하는 값",(function(){return t.constructor===b2.Fixture||t.constructor===Number})),t.constructor===Number&&(t=this.fixtureCache[t]),i.use&&i.validate("numberToFixture::idx 소유하지 않은2 픽스쳐",(function(){return t[n].drawInstance.pg===e})),i.use&&i.validate("numberToFixture::idx 소유하지 않은1 픽스쳐",(function(){return e.isFixtureBelongsToMe(t)})),t}},{key:"setSensor",value:function(t,e){this.setFixtureProp(t,"sensor",e),this.resetBodyAndFixtures(),this.setAwake(!0)}},{key:"isSensor",value:function(t){return void 0===t&&(t=0),this.getFixtureProp("sensor",t)}},{key:"setDensity",value:function(t,e){this.setFixtureProp(t,"density",e),this.resetBodyAndFixtures(),this.setAwake(!0)}},{key:"getDensity",value:function(t){return void 0===t&&(t=0),this.getFixtureProp("density",t)}},{key:"setRestitution",value:function(t,e){this.setFixtureProp(t,"restitution",e),this.resetBodyAndFixtures(),this.setAwake(!0)}},{key:"getRestitution",value:function(t){return void 0===t&&(t=0),this.getFixtureProp("restitution",t)}},{key:"setFriction",value:function(t,e){this.setFixtureProp(t,"friction",e),this.resetBodyAndFixtures(),this.setAwake(!0)}},{key:"getFriction",value:function(t){return void 0===t&&(t=0),this.getFixtureProp("friction",t)}},{key:"setDynamic",value:function(){g?this.planckBody.setDynamic():this.planckBody.SetType(b2.BodyType.b2_dynamicBody),this.setAwake(!0)}},{key:"isDynamic",value:function(){return g?this.planckBody.isDynamic():this.planckBody.GetType()===b2.BodyType.b2_dynamicBody}},{key:"setGravityScale",value:function(t){this.getBody().SetGravityScale(t)}},{key:"getGravityScale",value:function(){return this.getBody().GetGravityScale()}},{key:"setKinematic",value:function(){this.planckBody.SetType(b2.BodyType.b2_kinematicBody)}},{key:"isKinematic",value:function(){return this.planckBody.GetType()===b2.BodyType.b2_kinematicBody}},{key:"resetBodyAndFixtures",value:function(t){var e=this,r=this.getPosition(),o=r.x,a=r.y,s=g?this.planckBody.getGravityScale():this.planckBody.GetGravityScale(),c=g?this.planckBody.isDynamic():this.planckBody.GetType()===b2.BodyType.b2_dynamicBody,u=g?this.planckBody.isStatic():this.planckBody.GetType()===b2.BodyType.b2_staticBody,l=g?this.planckBody.isAwake():this.planckBody.IsAwake(),y=g?this.planckBody.getAngularVelocity():this.planckBody.GetAngularVelocity(),f=g?this.planckBody.getLinearDamping():this.planckBody.GetLinearDamping(),d=g?this.planckBody.getLinearVelocity():this.planckBody.GetLinearVelocity(),p=g?this.planckBody.isBullet():this.planckBody.IsBullet(),v=g?this.planckBody.isKinematic():this.planckBody.GetType()===b2.BodyType.b2_kinematicBody,x=g?this.planckBody.isFixedRotation():this.planckBody.IsFixedRotation(),w=this.getAngle(),k=new Map,b=[];if(g)for(var m=this.planckBody.getFixtureList();m;m=m.getNext()){var _,S,C;b.push(m);var B=t||m.getShape(),A=null===(_=m)||void 0===_?void 0:_.getRestitution(),E=null===(S=m)||void 0===S?void 0:S.getFriction(),O=null===(C=m)||void 0===C?void 0:C.getDensity();O=O||1,k.set(m,{shape:B,restitution:A,friction:E,density:O})}else for(var G=function(n){i.use&&i.validate("resetBodyAndFixtures::fixture 상태가 이상하네",(function(){return!!n})),i.use&&i.validate("resetBodyAndFixtures::픽스쳐가 아니네",(function(){return n.constructor===b2.Fixture})),b.push(n);var r=t||n.GetShape();k.set(n,P({shape:r},e.getFixtureValues(n)))},M=this.planckBody.GetFixtureList();M;M=M.GetNext())G(M);var F=[this].concat(h(this.getContactList(!0)));if(g||(b.forEach((function(t){return e.destroyFixture(t)})),this.planckBody.GetWorld().DestroyBody(this.planckBody)),g)this.planckBody=this.world.createBody({bullet:!1}),this.planckBody.setGravityScale(s),this.planckBody.setUserData(this),this.planckBody.setMassData({mass:1,center:planck.Vec2(0,0),I:1});else{var I=new b2.BodyDef;I.allowSleeping=!0,this.planckBody=this.world.CreateBody(I),this.planckBody.SetGravityScale(s),this.planckBody.SetUserData(this);var T=new b2.MassData;T.mass=1,T.center.x=0,T.center.y=0,T.I=1,this.planckBody.SetMassData(T)}b.reverse().forEach((function(t){var i=k.get(t),r=i.shape,o=i.restitution,a=i.friction,s=i.density,c=i.sensor,u=t[n];g||((t=e.createFixture(r)).SetRestitution(o||0),t.SetFriction(a||0),t.SetDensity(s||0),t.SetSensor(c),t[n]=u)})),this.setPosition(o,a),this.setAngle(w),g?c&&this.planckBody.setDynamic():c&&this.planckBody.SetType(b2.BodyType.b2_dynamicBody),g||(v&&this.planckBody.SetType(b2.BodyType.b2_kinematicBody),u&&this.planckBody.SetType(b2.BodyType.b2_staticBody),this.planckBody.SetBullet(p),this.planckBody.SetAwake(l),this.planckBody.SetFixedRotation(x),this.planckBody.SetAngularVelocity(y),this.planckBody.SetLinearDamping(f),this.planckBody.SetLinearVelocity(d)),g||F.forEach((function(t){return t.getBody().SetAwake(!0)}))}},{key:"justCalcuateMode",value:function(t){this.calculateMode=t}},{key:"setActive",value:function(t){var n=this;if(this.calculateMode)t?t&&(this.getBody()[e]=!t):(this.setStatic(),this.setPosition(a.BIGNUMBER,a.BIGNUMBER),this.planckBody.SetAngularVelocity(0),this.planckBody.SetLinearVelocity({x:0,y:0}),this.destroy(!0),this.getBody()[e]=!t);else{var i=this.getGraphic(),r=i.parent;t||!r||this.activeState.parent?t&&!r&&this.activeState.parent&&(this.activeState.parent.addChild(i),Object.keys(this.activeState).forEach((function(t){return delete n.activeState[t]})),this.getBody()[e]=!t):(this.setStatic(),this.setPosition(a.BIGNUMBER,a.BIGNUMBER),this.planckBody.SetAngularVelocity(0),this.planckBody.SetLinearVelocity({x:0,y:0}),this.destroy(!0),this.activeState.parent=r,r.removeChild(i),this.getBody()[e]=!t)}}},{key:"isActive",value:function(){return!this.getBody()[e]}},{key:"setAwake",value:function(t){g?this.getBody().setAwake(t):this.getBody().SetAwake(t)}},{key:"isAwake",value:function(){return g?this.getBody().isAwake():this.getBody().IsAwake()}},{key:"setStatic",value:function(){g?this.getBody().setStatic():this.getBody().SetType(b2.BodyType.b2_staticBody)}},{key:"isStatic",value:function(){return g?this.getBody().isStatic():this.getBody().GetType()===b2.BodyType.b2_staticBody}},{key:"isDestroy",value:function(){return!this.getGraphic().parent}},{key:"remAllpinGravities",value:function(){var t=this;this.getPinGravities().forEach((function(e){return t.remPinGravity(e)}))}},{key:"getKinematicMotions",value:function(){return[].concat(h(this.kinematicMotionMove.keys()),h(this.kinematicMotionRotate.keys()))}},{key:"destroy",value:function(t){var e,n=this;this.preCallbackQueue.splice(0,this.preCallbackQueue.length),this.getKinematicMotions().forEach((function(t){return t.clearPrm()})),this.remAllUpdate(),this.removeAllEvent(),this.remAllpinGravities(),this.removeAllVirtualChildren(),$.pixics.getJointList().forEach((function(t){var e=t.GetUserData();e.joints.map((function(t){return t.body})).includes(n)&&e.destroy()}));var i=this.getBody(),r=this.getGraphic();t||(this.removeDraw(),i.GetWorld().DestroyBody(i),null===(e=r.parent)||void 0===e||e.removeChild(r))}},{key:"setResistance",value:function(t,e){var n,i=this;this.resistanceFn&&$.pixics.unupdate(this.resistanceFn);var r=function r(o,s,c){var u=i.getBody().GetLinearVelocity(),l={x:0,y:0},h=a.get_angle_in_radian_between_two_points(l,u),y=1-t;y<0&&(y=0);var f=a.get_distance_between_two_point(l,u),d=Math.abs(f)*y,p=a.get_coordinate_distance_away_from_center_with_radian(d,l,h);i.getBody().SetLinearVelocity(p),n&&a.get_distance_between_two_point(i.getGraphic().position,n)<.01&&(i.getBody().SetLinearVelocity(new b2.Vec2(0,0)),$.pixics.unupdate(r),i.resistanceFn=null,e&&e(),s()),n={x:i.getGraphic().x,y:i.getGraphic().y}};this.resistanceFn=r,$.pixics.update(r)}}]),f}(),N=new Map,U=new Map,Q=function(t){var e=Symbol.for("timecount");void 0===t[e]&&(t[e]=0),t(1,t[Symbol.for("removeUpdate")],++t[e])},z=function(){return 2*u.worldscale},W=function(t){var e=u.worldscale;return t*k/e},J=b((function t(){w(this,t)}));m(J,"DOWN",["mousedown","touchstart"]),m(J,"MOVE",["mousemove","touchmove"]),m(J,"UP",["touchend","mouseup"].concat(["touchendoutside","mouseupoutside"]));var X=b((function t(){w(this,t)}));m(X,"CIRCLE",0),m(X,"RECTANGLE",1),m(X,"POLYGON",2);var q=function(){function t(e){w(this,t),this.pg=e.pg}return b(t,[{key:"color",get:function(){return this.tcode===X.CIRCLE?this.rawArg[3]:this.tcode===X.POLYGON?this.rawArg[1]:this.tcode===X.RECTANGLE?this.rawArg[4]:void 0},set:function(t){this.pg.setDrawColor(this.fixtureOrder,t,null)}},{key:"alpha",get:function(){return this.tcode===X.CIRCLE?this.rawArg[4]:this.tcode===X.POLYGON?this.rawArg[2]:this.tcode===X.RECTANGLE?this.rawArg[5]:void 0},set:function(t){this.pg.setDrawColor(this.fixtureOrder,null,t)}},{key:"x",get:function(){return this.rawArg[0]},set:function(t){var e=this.fixtureOrder;this.pg.setDrawAppearance(e,0,t)}},{key:"y",get:function(){return this.rawArg[1]},set:function(t){this._y=t;var e=this.fixtureOrder;this.pg.setDrawAppearance(e,1,t)}},{key:"tcode",get:function(){return this.fixture[n].tcode}},{key:"rawArg",get:function(){return this.fixture[n].rawArg}},{key:"fixture",get:function(){return this.pg.numberToFixture(this.fixtureOrder)}},{key:"fixtureOrder",get:function(){for(var t=this.pg.fixtureCache,e=0;e<t.length;e++)if(t[e][n].drawInstance===this)return e}}]),t}(),Y=function(t){v(n,t);var e=B(n);function n(t){return w(this,n),e.call(this,t)}return b(n,[{key:"radius",get:function(){return this.rawArg[2]},set:function(t){var e=this.fixtureOrder;this.pg.setDrawAppearance(e,2,t)}}]),n}(q),K=function(t){v(n,t);var e=B(n);function n(t){return w(this,n),e.call(this,t)}return b(n,[{key:"width",get:function(){return this.rawArg[2]},set:function(t){var e=this.fixtureOrder;this.pg.setDrawAppearance(e,2,t)}},{key:"height",get:function(){return this.rawArg[3]},set:function(t){var e=this.fixtureOrder;this.pg.setDrawAppearance(e,3,t)}}]),n}(q),H=function(t){v(n,t);var e=B(n);function n(t){return w(this,n),e.call(this,t)}return b(n,[{key:"path",get:function(){return this.rawArg[0]},set:function(t){var e=this.fixtureOrder;this.pg.setDrawAppearance(e,0,t)}}]),n}(q),Z=new Map,$={symbolValue:{},DrawType:X,KeyEvent:J,framerate:k,math:a,displaySystem:function(t,e,n){var i,r,o=c(t,2),s=o[0],u=o[1],l=n.constructor===HTMLBodyElement,h=!1;t.length<2&&(h=!0,s=a.EPSILON,u=a.EPSILON,h&&l&&window.addEventListener("resize",(function(t){return h&&i&&i()}))),e&&((r=document.createElement("script")).onload=function(){var t=new Stats;document.body.appendChild(t.dom),requestAnimationFrame((function e(){t.update(),requestAnimationFrame(e)}))},r.src="//mrdoob.github.io/stats.js/build/stats.min.js",document.head.appendChild(r));var y={width:s,height:u},f={createPIXIApp:function(t){var e=this,n=new PIXI.Application({width:e.width,height:e.height,antialias:!0,resolution:window.devicePixelRatio,autoDensity:!0}),r=new PIXI.Container;return r.zIndex=1,r.sortableChildren=!0,n.stage.addChild(r),$.particleContainer=r,$.pixiApp=n,t.rotation?(e.width=n.screen.height,e.height=n.screen.width):(e.width=n.screen.width,e.height=n.screen.height),n.stage.sortableChildren=!0,void 0===t.clearContainer&&(t.clearContainer=!0),t.clearContainer&&(e.container.innerText=""),e.container.appendChild(n.view),h&&l&&(i=function(){return n.renderer.resize(window.innerWidth,window.innerHeight)})(),t.rotation&&(n.stage.x=e.height,n.stage.rotation=Math.PI/2),n},log:function(t){},getRatio:function(){var t=h?y:n.getBoundingClientRect(),e=t.width,i=t.height;if(l)h?(n.style.margin="0px",n.style.backgroundColor="#000",n.style.overflow="hidden"):(e=window.innerWidth,i=window.innerHeight);else if(!(h||e&&i))throw new Error("부모의 크기가 작거나 돔트리에 붙어있지 않은 상태로 보입니다");var r=i/y.height;return y.width*r>e&&(r=e/y.width),r}};return f.ratio=f.getRatio(),f.width=f.ratio*s,f.height=f.ratio*u,f.container=n,f},worldscale:0,PhysicsGraphics:V,TextView:T,TextView2:M,ContactListener:R,Assert:i,Image:j,ObjectPool:G,Line:E,TilingLine:O,Rectangle:A,editorUrl:function(t,e){var n=encodeURIComponent(JSON.stringify(t)),i=document.createElement("a");i.innerHTML="편집기 열고싶다면 엔터를 쳐 주세요",i.setAttribute("href","https://kstost.github.io/PIXICS/editor.html#".concat(n)),e&&i.click(),e||(!e&&i.setAttribute("target","_blank"),document.body.innerHTML="",document.body.append(i),document.body.style.background="black",i.style.color="white",i.style.padding="50px",i.style.display="inline-block",i.focus())},transScale:function(t){return t/u.worldscale},createWorld:function(n,r,o,s,f){x=f,g=!s,$.ratio=r,$.worldscale=n*r;var d,p=g?new planck.World(o):new b2.World(o);return p.SetAllowSleeping(!0),function(t){var n;$.tickplay=!0,PIXI.Ticker.shared.add((function(i){if(($.goOneStep||$.tickplay)&&($.goOneStep=!1,void 0===n&&(n=0),(n+=i)>=1)){if(n-=1,g){t.step(1/k),t.clearForces();for(var r=t.getBodyList();r;r=r.getNext()){var o;null===(o=r.getUserData())||void 0===o||o.syncState()}}else t.Step(1/k,8,3),t.ClearForces(),function(t){for(var n=t.GetBodyList();n;n=n.GetNext())if(!n[e]){for(var i=n.GetUserData(),r=i.preCallbackQueue.length,o=0;o<r;o++)if(i.preCallbackQueue[o]){var a=c(i.preCallbackQueue[o],4);(0,a[0])(a[1],a[2],a[3])}if(i.preCallbackQueue.splice(0,r),i.updateQueue.size)for(var s=i.updateQueue.keys();;){var u=s.next();if(u.done)break;Q(u.value)}null==i||i.syncState()}}(t);for(var a=N.keys();;){var s=a.next(),u=s.value;if(s.done)break;Q(u)}for(var l=U.keys();;){var h=l.next(),y=h.value;if(h.done)break;var f=U.get(y);f.time-=1,f.time<=0&&(U.delete(y),y())}}}))}(p),p.SetContactListener(new R),$.pixics={setJoint:function(t,e,n,i){var r;return(r=$.pixics).setDistanceJoint.apply(r,arguments)},setDistanceJoint:function(t,e,n,o){function s(){if(o.app)return w}function c(t){var e=2*Math.PI-t.angle,n=Math.cos(e),i=Math.sin(e),r=t,o=t.pos;return{x:n*(r.x-o.x)+i*(r.y-o.y)+o.x,y:n*(r.y-o.y)-i*(r.x-o.x)+o.y}}var l,y=$.pixics;t.constructor===Array&&(t={body:t[0],x:t[1],y:t[2]}),e.constructor===Array&&(e={body:e[0],x:e[1],y:e[2]}),n||(n={collideConnected:!0}),void 0===t.x||t.y;var f=!(void 0===e.x||void 0===e.y);f||(e.x=0,e.y=0);var d=t.body,v=e.body;if(i.use&&i.validate("setDistanceJoint::문제있음1",(function(){return d instanceof V})),i.use&&i.validate("setDistanceJoint::문제있음2",(function(){return v instanceof V})),i.use&&i.validate("setDistanceJoint::문제있음3",(function(){return d.getGraphic().parent===v.getGraphic().parent})),d&&v){var g=d.getPosition(),x=v.getPosition();t.x-=g.x,t.y+=g.y,e.x-=x.x,e.y+=x.y,o=o||{color:65535,thickness:.5*r};var w=d.getGraphic().parent,k=[{body:v,origin:P({},x),anchor:e},{body:d,origin:P({},g),anchor:t}],b=f?new b2.DistanceJointDef:new b2.RevoluteJointDef,m=c({pos:g,x:t.x+2*g.x,y:t.y,angle:d.getAngle()}),_=c({pos:x,x:e.x+2*x.x,y:e.y,angle:v.getAngle()}),S=new b2.Vec2(m.x/y.worldscale,m.y/y.worldscale),C=new b2.Vec2(_.x/y.worldscale,_.y/y.worldscale);b.Initialize.apply(b,[v.getBody(),d.getBody()].concat(h(f?[C,S]:[S]))),Object.keys(n).forEach((function(t){return b[t]=n[t]}));var B=p.CreateJoint(b),A={joints:k,getJointWire:function(){return M},setWireThickness:function(t){s()&&o.thickness&&(M.thickness=t,O.clear(),O.beginFill(16777215),O.drawCircle(0,0,.5*t),O.endFill(),G.clear(),G.beginFill(16777215),G.drawCircle(0,0,.5*t),G.endFill())},setColor:function(t){s()&&o.thickness&&(O.tint=t,G.tint=t,M.tint=t)},destroy:function(){var t,e,n;i.use&&i.validate("setDistanceJoint::문제있음4",(function(){return void 0===l})),O&&(null===(t=O.parent)||void 0===t||t.removeChild(O)),G&&(null===(e=G.parent)||void 0===e||e.removeChild(G)),M&&(null===(n=M.parent)||void 0===n||n.removeChild(M)),p.DestroyJoint(B),l=!0}};B.SetUserData(A);var E=function(){var t=s();if(t&&o.thickness){var e=new PIXI.Graphics,n=new PIXI.Graphics,i=new u.Line;return t.addChild(e),t.addChild(n),t.addChild(i),{roundCap:e,roundECap:n,jointWire:i}}return{}}(),O=E.roundCap,G=E.roundECap,M=E.jointWire;return B.GetUserData().setWireThickness(o.thickness),B.GetUserData().setColor(o.color),s()&&o.thickness&&y.update((function(t,e,n){if(l)return e();B.GetUserData().joints.forEach((function(t,e){var n=t.body,i=t.origin,r=t.anchor;(r=P({},r)).x=-r.x;var o=a.get_angle_in_radian_between_two_points(r,i),s=a.get_distance_between_two_point(i,r),c=y.getWorldCenter(),u=a.get_coordinate_distance_away_from_center_with_radian(s,n.getPosition(),-o+n.getAngle());0===e?(M.ax=u.x+c.x,M.ay=-u.y+c.y,O.x=M.ax,O.y=M.ay):(M.bx=u.x+c.x,M.by=-u.y+c.y,G.x=M.bx,G.y=M.by)}))})),B}},world:p,get worldscale(){return $.worldscale},worldPositionToPIXIStyle:function(t){var e=this.getWorldCenter();return{x:t.x*$.worldscale+e.x,y:-t.y*$.worldscale+e.y}},getWorldCenter:function(){return _},moveWorldCenterTo:function(t,e){_.x=x.width/2,_.y=x.height/2,_.x+=t,_.y+=-e},moveWorldCenterBy:function(t,e){_.x+=t,_.y+=-e},valueLikeSymbol:function(t,e){return $.symbolValue[Symbol.for(t)]||($.symbolValue[Symbol.for(t)]=e()),$.symbolValue[Symbol.for(t)]},prepareImageResources:function(t){return l(S().mark((function e(){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={},Object.keys(t).forEach((function(e){n[e]=PIXI.Texture.from(t[e])}));case 2:if(!Object.keys(n).filter((function(t){return n[t].width*n[t].height<=1})).length){e.next=7;break}return e.next=5,new Promise((function(t){return setTimeout(t)}));case 5:e.next=2;break;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))()},log:function(t,e){var n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.paddingLeft="15px",n.style.paddingTop="0px",n.style.paddingBottom="5px",n.style.fontSize="15px",n.style.color="white",n.innerText=t,document.body.appendChild(n),n.measuredSize=n.getBoundingClientRect(),n.measuredSize.botpos=15,n.style.bottom=n.measuredSize.botpos+"px",h(Z.keys()).forEach((function(t){t.measuredSize.botpos+=n.measuredSize.height,t.style.bottom=t.measuredSize.botpos+"px",t.style.opacity="0.5"})),n.addEventListener("transitionend",(function(t){"filter"===t.propertyName&&(n.remove(),Z.delete(n))})),setTimeout((function(){n.style.transition="0.2s",n.style.filter="blur(0.2rem)",n.style.opacity="0"}),e||2e3),Z.set(n,!0)},setPlay:function(t){$.tickplay=void 0===t?!$.tickplay:!!t},getPlay:function(){return!!$.tickplay},goOneStep:function(){$.tickplay=!1,$.goOneStep=!0},update:(d=l(S().mark((function e(n,i){var r=this;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N.has(n)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new Promise((function(e){t(n,e,(function(t){return r.unupdate(n,t)}),i,N)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),function(t,e){return d.apply(this,arguments)}),unupdate:function(t,e){y(t,N,e)},setTimeout:function(t,e){U.set(t,{time:e/1e3*k})},sleep:function(t){var e=this;return new Promise((function(n){e.setTimeout(n,t)}))},getJointList:function(){for(var t=[],e=p.GetJointList();e;e=e.GetNext())t.push(e);return t.reverse()}},$.pixics.moveWorldCenterTo(0,0),$.pixics.moveWorldCenterBy(0,0),$.pixics}};return $}();return u}})()})();
//# sourceMappingURL=pixics.js.map